decisions = {

	hellenic_quest = {
		potential = {
			is_ruler = yes
			OR = {
				true_religion = hellenic_pagan
				true_religion = hellenic_pagan_reformed
			}
			NOT = { has_character_modifier = has_quested }
			NOT = { has_artifact = golden_fleece }
			NOT = { has_artifact = medusa_head }
		}
		allow = {
			is_incapable = no
			war = no
			in_command = no
			any_demesne_province = {
				is_occupied = no
			}
			prisoner = no
			scaled_wealth = 0.20
			age = 16
			prestige = 1000
			custom_tooltip = {
				text = health_travel_condition
				hidden_tooltip = {
					NOT = {	trait = pregnant }
					NOT = {	trait = incapable }
					NOT = {	trait = blinded }
					NOT = {	trait = has_tuberculosis }
					NOT = {	trait = has_typhoid_fever }
					NOT = {	trait = has_typhus }
					NOT = {	trait = has_bubonic_plague }
					NOT = {	trait = has_measles }
					NOT = {	trait = has_small_pox }
					NOT = {	trait = has_aztec_disease }
				}
			}
		}
		effect = {
			scaled_wealth = -0.20
			add_character_modifier = {
				name = has_quested
				duration = -1
			}
			hidden_tooltip = {
				character_event = { 
					id = MYTH.20
					days = 5
				}
			}
		}
		ai_will_do = {
			factor = 0.001 
			modifier = {
				factor = 0
				NOT = { age = 25 }
			}
			modifier = {
				factor = 3
				trait = zealous
			}
		}
	}
	
	# Reject materialism
	reject_materialism = {
		potential = {
			OR = {
				religion = waldensian
				religion = lollard
			}
			NOR = {
				trait = ascetic
				trait = monk
				trait = nun
			}
		}
		allow = {
			OR = {
				religion = waldensian
				AND = {
					religion = lollard
					is_priest = yes
				}
			}
			NOT = { wealth = 200 }
			NOT = { trait = greedy }
		}
		effect = {
			add_trait = ascetic
			hidden_tooltip = {
				character_event = { id = MYTHMORE.28 }
			}
		}
		ai_will_do = {
			factor = 0.01
			modifier = {
				factor = 2
				ai_zeal = 30
			}
			modifier = {
				factor = 1.5
				ai_zeal = 60
			}
			modifier = {
				factor = 1.5
				ai_zeal = 90
			}
			modifier = {
				factor = 2
				trait = charitable
			}
			modifier = {
				factor = 2
				NOT = { ai_greed = 0 }
			}
			modifier = {
				factor = 0.5
				ai_greed = 40
			}
			modifier = {
				factor = 0.5
				ai_greed = 80
			}
			modifier = {
				factor = 0.1
				trait = cynical
			}
		}
	}
	
	# Reject asceticism
	reject_asceticism = {
		potential = {
			OR = {
				religion = waldensian
				religion = lollard
			}
			trait = ascetic
		}
		allow = {
			piety = 400
		}
		effect = {
			remove_trait = ascetic
			piety = -400
			hidden_tooltip = {
				character_event = { id = MYTHMORE.29 }
			}
		}
		ai_will_do = {
			factor = 0.01
			modifier = {
				factor = 2
				ai_greed = 30
			}
			modifier = {
				factor = 2
				ai_greed = 60
			}
			modifier = {
				factor = 2
				ai_greed = 90
			}
			modifier = {
				factor = 5
				trait = cynical
			}
			modifier = {
				factor = 0.2
				trait = charitable
			}
			modifier = {
				factor = 0.8
				ai_zeal = 30
			}
			modifier = {
				factor = 0.8
				ai_zeal = 60
			}
			modifier = {
				factor = 0.8
				ai_zeal = 90
			}
		}
	}
	
	# Set up bank - currently only for draconic merchant republics. May add regular merchant republics.
	establish_bank = {
		only_playable = yes
		ai_check_interval = 3
		potential = {
			OR = {
				government = draconic_merchant_republic_government
				government = merchant_republic_government
			}
			NOR = {
				trait = banker
			}
		}
		allow = {
			wealth = 200
			prisoner = no
			NOR = {
				has_character_modifier = borrowed_from_bank
				has_character_modifier = borrowed_from_jews
				has_character_modifier = expelled_jewish
				has_character_modifier = refused_to_repay_loan
			}
		}
		effect = {
			wealth = -200
			custom_tooltip = {
				text = tt_create_bank_200
				hidden_tooltip = {
					add_trait = banker
					set_variable = { which = bank_total value = 200 }
				}
			}
		}
		ai_will_do = {
			factor = 0.05
			modifier = {
				factor = 2
				trait = dragon
			}
			modifier = {
				factor = 1.5
				wealth = 400
			}
			modifier = {
				factor = 1.5
				wealth = 800
			}
			modifier = {
				factor = 1.2
				trait = greedy
			}
		}
	}
	
	# Interact with your existing bank
	interact_with_bank = {
		only_playable = yes
		ai_check_interval = 3
		potential = {
			trait = banker
		}
		allow = {
			prisoner = no
		}
		effect = {
			custom_tooltip = {
				text = tt_interact_with_bank
				hidden_tooltip = {
					character_event = { id = BANK.1 }
				}
			}
		}
		ai_will_do = {
			factor = 0.1 # Interact frequently, since the important parts on are the internal weights
		}
	}
	
	# Borrow from bank
	borrow_from_bank = {
		only_playable = yes
		ai_check_interval = 3
		potential = {
			is_playable = yes
			is_nomadic = no
			NOR = {
				trait = banker
				has_character_modifier = borrowed_from_bank
				check_variable = { which = loan_amount value = 1 }
			}
		}
		allow = {
			NOR = {
				has_character_modifier = borrowed_from_bank
				has_character_modifier = borrowed_from_jews
				has_character_modifier = expelled_jewish
				has_character_modifier = refused_to_repay_loan
			}
			prisoner = no
			custom_tooltip = {
				text = tt_nearby_banker
				hidden_tooltip = {
					any_playable_ruler = {
						trait = banker
						ROOT = { capital_scope = { NOT = { distance = { who = PREV value = 300 } } } }
						# If I can find a clean way to require enough to cover the smallest loan, add it here
						check_variable = { which = bank_total value = 1 }
					}
				}
			}
		}
		effect = {
			custom_tooltip = {
				text = tt_contact_banker
				hidden_tooltip = {
					character_event = { id = BANK.2 }
				}
			}
		}
		ai_will_do = {
			factor = 0.01
			modifier = {
				factor = 0
				wealth = 0
				war = no
			}
			modifier = {
				factor = 0
				scaled_wealth = 2
				war = yes
			}
			modifier = {
				factor = 2
				NOT = { scaled_wealth = -1 }
			}
			modifier = {
				factor = 1.5
				trait = arbitrary
			}
		}
	}
	
	# Pay part of loan early
	replay_loan = {
		only_playable = yes
		ai_check_interval = 6
		potential = {
			is_playable = yes
			has_character_modifier = borrowed_from_bank
		}
		allow = {
			always = yes
		}
		effect = {
			custom_tooltip = {
				text = tt_interact_with_loan
				hidden_tooltip = {
					any_opinion_modifier_target = {
						limit = {
							has_opinion_modifier = {
								who = ROOT
								modifier = opinion_gave_loan
							}
						}
						character_event = { id = BANK.8 } # Ping your banker to set them as from
					}
				}
			}
		}
		ai_will_do = {
			factor = 0.5
			modifier = {
				factor = 0
				NOT = { scaled_wealth = 0.5 }
			}
			modifier = {
				factor = 1.5
				trait = midas_touched # Good with money, more likely to pay early and avoid interest
			}
			modifier = {
				factor = 1.3
				trait = fortune_builder # Good with money, more likely to pay early and avoid interest
			}
			modifier = {
				factor = 1.2
				OR = { # Debt is impure
					religion = draconic_pagan
					religion = draconic_pagan_reformed
				}
			}
		}
	}
}

targetted_decisions = {
	
	# Iconoclasts can destory icons for piety and revolt risk reduction
	destroy_icon = {
		filter = self
		ai_target_filter = self
		third_party_filter = artifacts
		ai_third_party_filter = artifacts
		
		potential = {
			character = FROM
			religion = iconoclast
			any_artifact = {
				OR = {
					has_artifact_flag = major_icon
					has_artifact_flag = minor_icon
				}
			}
		}
		third_party_potential = {
			FROMFROM = {
				OR = {
					has_artifact_flag = major_icon
					has_artifact_flag = minor_icon
				}
			}
		}
		allow = {
			show_only_failed_conditions = yes
			custom_tooltip = {
				text = tt_icon
				hidden_tooltip = {
					any_artifact = {
						OR = {
							has_artifact_flag = major_icon
							has_artifact_flag = minor_icon
						}
					}
				}
			}
		}
		third_party_allow = {
			FROMFROM = {
				OR = {
					has_artifact_flag = major_icon
					has_artifact_flag = minor_icon
				}
			}
		}
		effect = {
			if = {
				limit = { FROMFROM = { has_artifact_flag = major_icon } }
				custom_tooltip = {
					text = tt_destroy_icon_major
				}
			}
			if = {
				limit = { FROMFROM = { has_artifact_flag = minor_icon } }
				custom_tooltip = {
					text = tt_destroy_icon_minor
				}
			}
			hidden_tooltip = {
				character_event = { id = MYTHMORE.30 }
			}
		}
		ai_will_do = {
			factor = 0.01
			modifier = {
				factor = 2
				ai_zeal = 30
			}
			modifier = {
				factor = 2
				ai_zeal = 60
			}
			modifier = {
				factor = 2
				ai_zeal = 90
			}
			modifier = {
				factor = 2
				trait = diligent
			}
			modifier = {
				factor = 3
				OR = {
					trait = theologian
					trait = heresiarch
				}
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
			modifier = {
				factor = 0
				has_secret_religion = yes
				secret_religion_group = christian
			}
			modifier = {
				factor = 0.1 # Avoid getting too aggressive
				OR = {
					has_character_modifier = destroyed_major_icon_character
					has_character_modifier = destroyed_minor_icon_character
				}
			}
		}
		third_party_score = {
			factor = 1
			modifier = {
				factor = 2 # Prefer minor artifacts to avoid being too disruptive to gameplay
				has_artifact_flag = minor_icon
			}
		}
	}
	
	donate_artifact = {
		filter = self
		ai_target_filter = self
		third_party_filter = artifacts
		ai_third_party_filter = artifacts
		third_party = FROM
		
		potential = {
			character = FROM
			is_antimaterialist = yes
			any_artifact = {
				has_artifact_flag = wealth
			}
		}
		third_party_potential = {
			FROMFROM = { has_artifact_flag = wealth }
		}
		allow = {
			show_only_failed_conditions = yes
			custom_tooltip = {
				text = tt_valueable_artifact
				hidden_tooltip = {
					any_artifact = {
						has_artifact_flag = wealth
					}
				}
			}
		}
		third_party_allow = {
			FROMFROM = { has_artifact_flag = wealth }
		}
		effect = {
			custom_tooltip = {
				text = tt_destroy_wealth
			}
			hidden_tooltip = {
				character_event = { id = MYTHMORE.31 }
			}
		}
		ai_will_do = {
			factor = 0.02
			modifier = {
				factor = 0.5
				ai_greed = 25
			}
			modifier = {
				factor = 0.5
				ai_greed = 50
			}
			modifier = {
				factor = 0.5
				ai_greed = 75
			}
			modifier = {
				factor = 0.5
				ai_greed = 100
			}
			modifier = {
				factor = 1.5
				ai_greed <= -25
			}
			modifier = {
				factor = 1.5
				ai_greed <= -50
			}
			modifier = {
				factor = 1.5
				ai_greed <= -75
			}
			modifier = {
				factor = 1.5
				ai_greed <= -100
			}
			modifier = {
				factor = 1.2
				ai_zeal = 50
			}
			modifier = {
				factor = 1.2
				ai_zeal = 100
			}
			modifier = {
				factor = 1.5
				is_priest = yes
			}
		}
		third_party_score = {
			factor = 1
		}
	}
	
	targetted_borrow_from_bank = {
		filter = all # Not anything closer for all rulers
		ai_target_filter = none # They just use the normal decision
		
		from_potential = {
			is_playable = yes
			is_nomadic = no
			NOR = {
				trait = banker
				has_character_modifier = borrowed_from_bank
				has_character_modifier = borrowed_from_jews
				has_character_modifier = expelled_jewish
				has_character_modifier = refused_to_repay_loan
				check_variable = { which = loan_amount value = 1 }
			}
			prisoner = no
		}
		potential = {
			trait = banker
			# If I can find a clean way to require enough to cover the smallest loan, add it here
			check_variable = { which = bank_total value = 1 }
		}
		allow = {
			custom_tooltip = {
				text = tt_bank_has_money
				hidden_tooltip = { check_variable = { which = bank_total value = 1 } }
			}
			NOT = { distance = { who = FROM value = 300 } }
		}
		effect = {
			custom_tooltip = {
				text = tt_contact_selected_banker
				hidden_tooltip = {
					character_event = { id = BANK.5 }
				}
			}
		}
		ai_will_do = {
			factor = 0
		}
	}
}