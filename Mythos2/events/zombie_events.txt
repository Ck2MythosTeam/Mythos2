namespace = ZOMBIE
### Events related to Zombies

# ZOMBIE.1 - was MYTH.1 - Cursed to become Zombie
character_event = {
	id = "ZOMBIE.1"
	title = EVTNAME_ZOMBIE.1
	desc = "EVTDESC_ZOMBIE.1"
	picture = GFX_evt_crusaders
	border = GFX_event_normal_frame_war
	
	prisoner = no
	culture = manden
	
	mean_time_to_happen = {
		months = 10000
		modifier = {
			NOT = { religion = west_african_pagan }
			factor = 2
		}
		modifier = {
			factor = 0.2
			has_dlc = "Reapers" # RIP uses a plague, so curse is less common
		}
	}
	
	option = {
		name = "EVTOPTA_ZOMBIE.1"
		add_trait = zombie
	}
}

# ZOMBIE.2 - was MYTH.2 - Form the Horde
character_event = {
	id = "ZOMBIE.2"
	title = EVTNAME_ZOMBIE.2
	desc = "EVTDESC_ZOMBIE.2"
	picture = GFX_evt_crusaders
	border = GFX_event_normal_frame_war
	
	only_rulers = yes
	prisoner = no
	
	trigger = {
		#is_ruler = yes
		#prisoner = no
		trait = zombie
		e_zombie = { has_holder = no }
	}
	
	mean_time_to_happen = { months = 1 }
	
	option = {
		name = "EVTOPTA_ZOMBIE.2"
		set_defacto_liege = ROOT
		e_zombie = {
			grant_title = ROOT
		}
		
		capital_scope = {
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					troops = {
						zombie_troops = { 2000 2000 }
					}
				}
			}
			
			hidden_tooltip = {
				create_character = {
					random_traits = yes
					dynasty = none
					religion = ROOT
					culture = ROOT
					female = no
					age = 23
					attributes = {
						martial = 5
					}
					trait = zombie
				}
				create_character = {
					random_traits = yes
					dynasty = none
					religion = ROOT
					culture = ROOT
					female = no
					age = 30
					attributes = {
						martial = 5
					}
					trait = zombie
				}
				create_character = {
					random_traits = yes
					dynasty = none
					religion = ROOT
					culture = ROOT
					female = no
					age = 31
					attributes = {
						martial = 5
					}
					trait = zombie
				}
			}
		}
	}
}

# ZOMBIE.3 - was MYTH.3 - Zombie faith conversion
character_event = {
	id = "ZOMBIE.3"
	title = EVTNAME_ZOMBIE.3
	desc = "EVTDESC_ZOMBIE.3"
	picture = GFX_evt_crusaders
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	trigger = {
		trait = zombie
		NOT = { religion = voodoo }
	}
	
	option = {
		name = "EVTOPTA_ZOMBIE.3"
		religion = voodoo
		culture = zombie_culture
	}
}

# ZOMBIE.4 - was MYTH.4 - Horde Grows
character_event = {
	id = "ZOMBIE.4"
	title = EVTNAME_ZOMBIE.4
	desc = "EVTDESC_ZOMBIE.4"
	picture = GFX_evt_crusaders
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	
	option = {
		name = "EVTOPTA_ZOMBIE.4"
		
		capital_scope = {
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					troops = {
						zombie_troops = { 2000 2000 }
					}
				}
			}
			hidden_tooltip = {
				create_character = {
					random_traits = yes
					dynasty = none
					religion = ROOT
					culture = ROOT
					female = no
					age = 23
					attributes = {
						martial = 5
					}
					trait = zombie
				}
			}
		}
	}
}

# ZOMBIE.5 - was MYTH.5 - Submit to plague
character_event = {
	id = "ZOMBIE.5"
	title = EVTNAME_ZOMBIE.5
	desc = "EVTDESC_ZOMBIE.5"
	picture = GFX_evt_crusaders
	border = GFX_event_normal_frame_war
	
	only_rulers = yes
	prisoner = no
	
	trigger = {
		#is_ruler = yes
		trait = zombie
		#prisoner = no
		e_zombie = { has_holder = yes }
		top_liege = {
			NOT = {
				has_landed_title = e_zombie 
			}
		}
	}
	
	mean_time_to_happen = {
		months = 240
	}
	
	option = {
		name = "EVTOPTA_ZOMBIE.5"
		set_defacto_liege = e_zombie
	}
}

# ZOMBIE.6 - was MYTH.15 - Succumb to Zombie Plague
character_event = {
	id = "ZOMBIE.6"
	title = EVTNAME_ZOMBIE.6
	desc = "EVTDESC_ZOMBIE.6"
	picture = GFX_evt_crusaders
	border = GFX_event_normal_frame_war

	trigger = { 
		top_liege = {
			trait = zombie
		}
		NOT = { trait = zombie }
	}
	
	mean_time_to_happen = { months = 3 }
	
	option = {
		name = "EVTOPTA_ZOMBIE.6"
		add_trait = zombie
	}
}

# ZOMBIE.7 - was MYTH.91 - Horde Exterminates populace
# Note - uses original mechanics.  Later make a Reaper's Due version using Depopulation
province_event = {
	id = ZOMBIE.7
	title = EVTNAME_ZOMBIE.7
	desc = EVTDESC_ZOMBIE.7
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_diplomacy
	
	trigger = {
		NOT = { culture = zombie_culture }
		owner = { trait = zombie }
	}
	
	mean_time_to_happen = {
		months = 36
	}

	option = {
		name = EVTOPTA_ZOMBIE.7
		culture = zombie_culture
		religion = voodoo
		owner = {
			spawn_unit = {
				#province = { PREV = { random_demesne_province } }
				province = ROOT
				owner = THIS
				troops = {
					zombie_troops = { 250 250 }
				}
			}
		}
	}
}

# ZOMBIE.8 - was MYTH.92 - Province reclaimed from Zombies
# Based off original mechanic - remake a RD version using Depopulation/Prosperity
character_event = {
	id = "ZOMBIE.8"
	title = EVTNAME_ZOMBIE.8
	desc = "EVTDESC_ZOMBIE.8"
	picture = GFX_evt_viking_throneroom_oldgods
	border = GFX_event_normal_frame_diplomacy
	
	trigger = {
		any_demesne_title = { culture = zombie_culture }
		NOT = { trait = zombie }
	}
	
	mean_time_to_happen = {
		months = 36
	}

	option = {
		name = EVTOPTA_ZOMBIE.8
		random_demesne_province = {
			limit = { culture = zombie_culture }
			culture = ROOT
			religion = ROOT
		}
	}
}

# ZOMBIE.9 - was MYTH.93 - Zombie Law Change
character_event = {
	id = "ZOMBIE.9"
	title = EVTNAME_ZOMBIE.9
	desc = "EVTDESC_ZOMBIE.9"
	picture = GFX_evt_throne_room
	border = GFX_event_normal_frame_war
	
	trigger = {
		has_landed_title = e_zombie
		NOT = { has_law = zombie_law }
	}
	
	mean_time_to_happen = { months = 1 }
	
	option = {
		name = "EVTOPTA_ZOMBIE.9"
		e_zombie = {
			add_law = zombie_law
		}
	}
}

# ZOMBIE.10 - Get Zombie Plague
#Zombie Plague: chest_pain cramps headache abdominal_pain
character_event = { 
	id = ZOMBIE.10
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			100 = {
				modifier = {
					factor = 0
					num_of_symptoms = 3
				}
				add_zombie_plague_symptom_effect = yes #Disease effect
			}
			50 = {
				modifier = {
					factor = 0
					NOR = {
						trait = headache
						trait = chest_pain
						trait = cramps
						trait = abdominal_pain
					}
				}
				character_event = { id = ZOMBIE.11 days = 20 random = 20 } #Disease develops
			}
		}
	}
}

# ZOMBIE.11 - Zombie Plague manifests - chest_pain cramps headache abdominal_pain
character_event = { 
	id = ZOMBIE.11
	desc = EVTDESCZOMBIE.11
	picture = GFX_evt_illness
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = ALAS
		add_trait = zombie_infection
		set_character_flag = manifest_zombie_plague
		add_disease_level_effect = yes
		blessing_removes_disease_effect = yes
		deaths_gift_removes_disease_effect = yes
		clr_character_flag = developing_illness
		clr_character_flag = got_zombie_plague
		if = {
			limit = {
				trait = chest_pain
			}
			remove_trait = chest_pain
		}
		if = {
			limit = {
				trait = cramps
			}
			remove_trait = cramps
		}
		if = {
			limit = {
				trait = headache
			}
			remove_trait = headache
		}
		if = {
			limit = {
				trait = abdominal_pain
			}
			remove_trait = abdominal_pain
		}
		hidden_tooltip = {
			if = {
				limit = {
					is_unimportant_trigger = yes
				}
				health = -3
			}
			host = {
				random_courtier_or_vassal = { #Markus doing
					limit = {
						liege = { character = PREVPREV }
						has_minor_title = title_court_physician
					}
					character_event = { id = RIP.11031 days = 1 }
				}
			}
			father = {
				if = {
					limit = { 
						ai = no 
						is_liege_of = ROOT
					}
					set_character_flag = announce_zombie_plague
					character_event = { id = RIP.5060 }
				}
			}
			mother = {
				if = {
					limit = { 
						ai = no 
						is_liege_of = ROOT
					}
					set_character_flag = announce_zombie_plague
					character_event = { id = RIP.5060 }
				}
			}
			spouse = {
				if = {
					limit = { ai = no }
					set_character_flag = announce_zombie_plague
					character_event = { id = RIP.5060 }
				}
			}
			# If still alive and infected in 30 days, chance of becoming a zombie
			character_event = { id = ZOMBIE.12 days = 30 }
		}
	}
}

# ZOMBIE.12 -  Chance to become a zombie
character_event = {
	id = ZOMBIE.12
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			90 = {
				character_event = { id = ZOMBIE.12 days = 30 }
			}
			10 = {
				modifier = {
					factor = 2
					religion = voodoo
				}
				modifier = {
					factor = 1.5
					liege = { trait = zombie }
				}
				modifier = {
					factor = 1.4
					religion = west_african_pagan
				}
				modifier = {
					factor = 1.1
					culture = manden
				}
				character_event = { id = ZOMBIE.13 }
			}
		}
	}
}

# ZOMBIE.13 - Convert to zombie
character_event = {
	id = ZOMBIE.13
	desc = EVTDESCZOMBIE.13
	picture = GFX_evt_danse_macabre
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAZOMBIE.14
		add_trait = zombie
		remove_trait = zombie_infection
	}
}